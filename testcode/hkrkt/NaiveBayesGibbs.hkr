[(fn topic_prior ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat)))))) [(fn word_prior ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat))))) [(fn z ((array nat) -> ((array nat) -> (nat -> (measure nat)))) [(fn w ((array nat) -> (nat -> (measure nat))) [(fn doc (nat -> (measure nat)) [(fn docUpdate (measure nat) [(match [(< [docUpdate : nat] [(size [z : (array nat)]) : nat]) : bool] ((pdatum true (pc_inl (ps_done))) [(pose [(* [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (iB [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(product (j [0 : nat] [(let (summary (pair unit (array (array nat))) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_split (bind iF [(== [docUpdate : nat] [(index [doc : (array nat)] [iF : nat]) : nat]) : bool]) r_nop (r_index [(size [word_prior : (array prob)]) : nat] (bind iF [(index [w : (array nat)] [iF : nat]) : nat]) (r_index (bind iB [(size [topic_prior : (array prob)]) : nat]) (bind iF (bind iB [(index [z : (array nat)] [(index [doc : (array nat)] [iF : nat]) : nat]) : nat])) (r_add (bind iF (bind i (bind iB [1 : nat])))))))) : (pair unit (array (array nat)))]) [(index [(index [(match [summary : (pair unit (array (array nat)))] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z z)))) : (array (array nat))] [iB : nat]) : (array nat)] [i : nat]) : nat]) : nat]) [(+ [(nat2prob [j : nat]) : prob][(index [word_prior : (array prob)] [iB : nat]) : prob]) : prob]) : prob]) : prob]) : prob][(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (j [0 : nat] [(let (summary (array nat) [(bucket [0 : nat] [(size [z : (array nat)]) : nat] (r_index [(size [topic_prior : (array prob)]) : nat] (bind iF [(index [z : (array nat)] [iF : nat]) : nat]) (r_add (bind iF (bind i [1 : nat]))))) : (array nat)]) [(int2nat [(+ [(* [(nat2int [(match [(and [(not [(< [(+ [(nat2int [(size [topic_prior : (array prob)]) : nat]) : int][-1 : int]) : int] [(nat2int [(index [z : (array nat)] [docUpdate : nat]) : nat]) : int]) : bool]) : bool][(== [i : nat] [(index [z : (array nat)] [docUpdate : nat]) : nat]) : bool]) : bool] ((pdatum true (pc_inl (ps_done))) [1 : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : int][-1 : int]) : int][(nat2int [(index [summary : (array nat)] [i : nat]) : nat]) : int]) : int]) : nat]) : nat]) [(+ [(nat2prob [j : nat]) : prob][(index [topic_prior : (array prob)] [i : nat]) : prob]) : prob]) : prob]) : prob][(recip [(product (i [0 : nat] [(summate (iF [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [iF : nat] [docUpdate : nat]) : bool] ((pdatum true (pc_inl (ps_done))) [0 : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [1 : nat])) : nat]) : nat]) [(+ [(nat2prob [i : nat]) : prob][(summate (iF [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(index [topic_prior : (array prob)] [iF : nat]) : prob]) : prob]) : prob]) : prob]) : prob][(recip [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (iB [0 : nat] [(let (summary (pair unit (array nat)) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_split (bind iF [(== [docUpdate : nat] [(index [doc : (array nat)] [iF : nat]) : nat]) : bool]) r_nop (r_index [(size [topic_prior : (array prob)]) : nat] (bind iF [(index [z : (array nat)] [(index [doc : (array nat)] [iF : nat]) : nat]) : nat]) (r_add (bind iF (bind i [1 : nat])))))) : (pair unit (array nat))]) [(index [(match [summary : (pair unit (array nat))] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z z)))) : (array nat)] [i : nat]) : nat]) : nat]) [(+ [(nat2prob [iB : nat]) : prob][(summate (iF [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(index [word_prior : (array prob)] [iF : nat]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob][(recip [(+ [(nat2prob [(summate (iF [0 : nat] [(size [z : (array nat)]) : nat]) [(match [(== [iF : nat] [docUpdate : nat]) : bool] ((pdatum true (pc_inl (ps_done))) [0 : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [1 : nat])) : nat]) : nat]) : prob][(summate (iF [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(index [topic_prior : (array prob)] [iF : nat]) : prob]) : prob]) : prob]) : prob]) : prob] [(categorical [(array (zNewf [(size [topic_prior : (array prob)]) : nat]) [(real2prob [(* [(prob2real [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (iB [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(product (j [0 : nat] [(let (summary (pair (array (array nat)) unit) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_fanout (r_index [(size [z : (array nat)]) : nat] (bind iF [(index [doc : (array nat)] [iF : nat]) : nat]) (r_index (bind docUpdate [(size [word_prior : (array prob)]) : nat]) (bind iF (bind docUpdate [(index [w : (array nat)] [iF : nat]) : nat])) (r_add (bind iF (bind iB (bind docUpdate [1 : nat])))))) r_nop)) : (pair (array (array nat)) unit)]) [(match [(== [i : nat] [zNewf : nat]) : bool] ((pdatum true (pc_inl (ps_done))) [(index [(index [(match [summary : (pair (array (array nat)) unit)] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z y)))) : (array (array nat))] [docUpdate : nat]) : (array nat)] [iB : nat]) : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : nat]) [(+ [(nat2prob [(let (summary (pair unit (array (array nat))) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_split (bind iF [(== [(index [doc : (array nat)] [iF : nat]) : nat] [docUpdate : nat]) : bool]) r_nop (r_index [(size [word_prior : (array prob)]) : nat] (bind iF [(index [w : (array nat)] [iF : nat]) : nat]) (r_index (bind iB [(size [topic_prior : (array prob)]) : nat]) (bind iF (bind iB [(index [z : (array nat)] [(index [doc : (array nat)] [iF : nat]) : nat]) : nat])) (r_add (bind iF (bind i (bind iB [1 : nat])))))))) : (pair unit (array (array nat)))]) [(index [(index [(match [summary : (pair unit (array (array nat)))] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z z)))) : (array (array nat))] [iB : nat]) : (array nat)] [i : nat]) : nat]) : nat]) : prob][(nat2prob [j : nat]) : prob][(index [word_prior : (array prob)] [iB : nat]) : prob]) : prob]) : prob]) : prob]) : prob]) : real][(+ [(int2real [(let (summary (array nat) [(bucket [0 : nat] [(size [z : (array nat)]) : nat] (r_index [(size [topic_prior : (array prob)]) : nat] (bind iF [(index [z : (array nat)] [iF : nat]) : nat]) (r_add (bind iF (bind zNewf [1 : nat]))))) : (array nat)]) [(+ [(* [(nat2int [(match [(and [(not [(< [(+ [(nat2int [(size [topic_prior : (array prob)]) : nat]) : int][-1 : int]) : int] [(nat2int [(index [z : (array nat)] [docUpdate : nat]) : nat]) : int]) : bool]) : bool][(== [zNewf : nat] [(index [z : (array nat)] [docUpdate : nat]) : nat]) : bool]) : bool] ((pdatum true (pc_inl (ps_done))) [1 : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : int][-1 : int]) : int][(nat2int [(index [summary : (array nat)] [zNewf : nat]) : nat]) : int]) : int]) : int]) : real][(prob2real [(index [topic_prior : (array prob)] [zNewf : nat]) : prob]) : real]) : real][(prob2real [(recip [(product (i [0 : nat] [(size [topic_prior : (array prob)]) : nat]) [(product (iB [0 : nat] [(let (summary (pair (array nat) unit) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_fanout (r_index [(size [z : (array nat)]) : nat] (bind iF [(index [doc : (array nat)] [iF : nat]) : nat]) (r_add (bind iF (bind docUpdate [1 : nat])))) r_nop)) : (pair (array nat) unit)]) [(match [(== [i : nat] [zNewf : nat]) : bool] ((pdatum true (pc_inl (ps_done))) [(index [(match [summary : (pair (array nat) unit)] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z y)))) : (array nat)] [docUpdate : nat]) : nat]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [0 : nat])) : nat]) : nat]) [(+ [(nat2prob [(let (summary (pair unit (array nat)) [(bucket [0 : nat] [(size [w : (array nat)]) : nat] (r_split (bind iF [(== [(index [doc : (array nat)] [iF : nat]) : nat] [docUpdate : nat]) : bool]) r_nop (r_index [(size [topic_prior : (array prob)]) : nat] (bind iF [(index [z : (array nat)] [(index [doc : (array nat)] [iF : nat]) : nat]) : nat]) (r_add (bind iF (bind i [1 : nat])))))) : (pair unit (array nat))]) [(index [(match [summary : (pair unit (array nat))] ((pdatum pair (pc_inl (ps_et (pf_konst var) (ps_et (pf_konst var) (ps_done))))) (bind y (bind z z)))) : (array nat)] [i : nat]) : nat]) : nat]) : prob][(nat2prob [iB : nat]) : prob][(summate (iF [0 : nat] [(size [word_prior : (array prob)]) : nat]) [(index [word_prior : (array prob)] [iF : nat]) : prob]) : prob]) : prob]) : prob]) : prob]) : prob]) : real]) : real]) : prob]) : (array prob)]) : (measure nat)]) : (measure nat)]) ((pdatum false (pc_inr (pc_inl (ps_done)))) [(reject) : (measure nat)])) : (measure nat)]) : (nat -> (measure nat))]) : ((array nat) -> (nat -> (measure nat)))]) : ((array nat) -> ((array nat) -> (nat -> (measure nat))))]) : ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat)))))]) : ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat))))))]) : ((array prob) -> ((array prob) -> ((array nat) -> ((array nat) -> ((array nat) -> (nat -> (measure nat)))))))]
